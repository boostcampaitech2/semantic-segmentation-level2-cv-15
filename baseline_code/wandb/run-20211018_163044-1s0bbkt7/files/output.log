Number of super categories: 10
Number of categories: 10
Number of annotations: 26240
Number of images: 3272
loading annotations into memory...
Done (t=4.15s)
creating index...
index created!
loading annotations into memory...
Done (t=0.90s)
creating index...
index created!
loading annotations into memory...
Done (t=0.02s)
creating index...
index created!
image shape: [3, 512, 512]
mask shape:  [512, 512]
Unique values, category of transformed mask :
 [{0, 'Backgroud'}, {'Paper', 2}, {8, 'Plastic bag'}]
image shape: [3, 512, 512]
mask shape:  [512, 512]
Unique values, category of transformed mask :
 [{0, 'Backgroud'}, {'Glass', 5}, {'Plastic', 6}, {8, 'Plastic bag'}]
image shape: [3, 512, 512]
input shape : torch.Size([2, 3, 512, 512])
output shape : torch.Size([2, 11, 512, 512])
Start training..
Epoch [1/100], Step [25/164],                         Loss: 1.1083, mIoU: 0.1623
Epoch [1/100], Step [50/164],                         Loss: 0.8856, mIoU: 0.195
Epoch [1/100], Step [75/164],                         Loss: 0.9363, mIoU: 0.2032
Process wandb_internal:
Traceback (most recent call last):
  File "/opt/conda/envs/segmentation/lib/python3.7/multiprocessing/process.py", line 297, in _bootstrap
    self.run()
  File "/opt/conda/envs/segmentation/lib/python3.7/multiprocessing/process.py", line 99, in run
    self._target(*self._args, **self._kwargs)
  File "/opt/conda/envs/segmentation/lib/python3.7/site-packages/wandb/sdk/internal/internal.py", line 152, in wandb_internal
    thread.join()
  File "/opt/conda/envs/segmentation/lib/python3.7/threading.py", line 1044, in join
    self._wait_for_tstate_lock()
  File "/opt/conda/envs/segmentation/lib/python3.7/threading.py", line 1060, in _wait_for_tstate_lock
    elif lock.acquire(block, timeout):
KeyboardInterrupt
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/opt/conda/envs/segmentation/lib/python3.7/multiprocessing/spawn.py", line 105, in spawn_main
    exitcode = _main(fd)
  File "/opt/conda/envs/segmentation/lib/python3.7/multiprocessing/spawn.py", line 118, in _main
    return self._bootstrap()
  File "/opt/conda/envs/segmentation/lib/python3.7/multiprocessing/process.py", line 315, in _bootstrap
    threading._shutdown()
  File "/opt/conda/envs/segmentation/lib/python3.7/threading.py", line 1307, in _shutdown
    lock.acquire()
KeyboardInterrupt
ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.
ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.
Traceback (most recent call last):
  File "/opt/conda/envs/segmentation/lib/python3.7/site-packages/IPython/core/interactiveshell.py", line 3444, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "/tmp/ipykernel_28724/295132338.py", line 1, in <module>
    train(num_epochs, model, train_loader, val_loader, criterion, optimizer, saved_dir, val_every, device)
  File "/tmp/ipykernel_28724/2712978356.py", line 34, in train
    loss.backward()
  File "/opt/conda/envs/segmentation/lib/python3.7/site-packages/torch/tensor.py", line 221, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph)
  File "/opt/conda/envs/segmentation/lib/python3.7/site-packages/torch/autograd/__init__.py", line 132, in backward
    allow_unreachable=True)  # allow_unreachable flag
KeyboardInterrupt
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/opt/conda/envs/segmentation/lib/python3.7/site-packages/IPython/core/interactiveshell.py", line 2064, in showtraceback
    stb = value._render_traceback_()
AttributeError: 'KeyboardInterrupt' object has no attribute '_render_traceback_'
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/opt/conda/envs/segmentation/lib/python3.7/site-packages/IPython/core/ultratb.py", line 1101, in get_records
    return _fixed_getinnerframes(etb, number_of_lines_of_context, tb_offset)
  File "/opt/conda/envs/segmentation/lib/python3.7/site-packages/IPython/core/ultratb.py", line 248, in wrapped
    return f(*args, **kwargs)
  File "/opt/conda/envs/segmentation/lib/python3.7/site-packages/IPython/core/ultratb.py", line 281, in _fixed_getinnerframes
    records = fix_frame_records_filenames(inspect.getinnerframes(etb, context))
  File "/opt/conda/envs/segmentation/lib/python3.7/inspect.py", line 1502, in getinnerframes
    frameinfo = (tb.tb_frame,) + getframeinfo(tb, context)
  File "/opt/conda/envs/segmentation/lib/python3.7/inspect.py", line 1460, in getframeinfo
    filename = getsourcefile(frame) or getfile(frame)
  File "/opt/conda/envs/segmentation/lib/python3.7/inspect.py", line 696, in getsourcefile
    if getattr(getmodule(object, filename), '__loader__', None) is not None:
  File "/opt/conda/envs/segmentation/lib/python3.7/inspect.py", line 742, in getmodule
    os.path.realpath(f)] = module.__name__
  File "/opt/conda/envs/segmentation/lib/python3.7/posixpath.py", line 395, in realpath
    path, ok = _joinrealpath(filename[:0], filename, {})
  File "/opt/conda/envs/segmentation/lib/python3.7/posixpath.py", line 429, in _joinrealpath
    if not islink(newpath):
  File "/opt/conda/envs/segmentation/lib/python3.7/posixpath.py", line 171, in islink
    st = os.lstat(path)
KeyboardInterrupt
Traceback (most recent call last):
  File "/opt/conda/envs/segmentation/lib/python3.7/site-packages/IPython/core/interactiveshell.py", line 3444, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "/tmp/ipykernel_28724/295132338.py", line 1, in <module>
    train(num_epochs, model, train_loader, val_loader, criterion, optimizer, saved_dir, val_every, device)
  File "/tmp/ipykernel_28724/2712978356.py", line 34, in train
    loss.backward()
  File "/opt/conda/envs/segmentation/lib/python3.7/site-packages/torch/tensor.py", line 221, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph)
  File "/opt/conda/envs/segmentation/lib/python3.7/site-packages/torch/autograd/__init__.py", line 132, in backward
    allow_unreachable=True)  # allow_unreachable flag
KeyboardInterrupt
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/opt/conda/envs/segmentation/lib/python3.7/site-packages/IPython/core/interactiveshell.py", line 2064, in showtraceback
    stb = value._render_traceback_()
AttributeError: 'KeyboardInterrupt' object has no attribute '_render_traceback_'
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/opt/conda/envs/segmentation/lib/python3.7/site-packages/IPython/core/interactiveshell.py", line 3364, in run_ast_nodes
    if (await self.run_code(code, result,  async_=asy)):
  File "/opt/conda/envs/segmentation/lib/python3.7/site-packages/IPython/core/interactiveshell.py", line 3461, in run_code
    self.showtraceback(running_compiled_code=True)
  File "/opt/conda/envs/segmentation/lib/python3.7/site-packages/IPython/core/interactiveshell.py", line 2067, in showtraceback
    value, tb, tb_offset=tb_offset)
  File "/opt/conda/envs/segmentation/lib/python3.7/site-packages/IPython/core/ultratb.py", line 1368, in structured_traceback
    self, etype, value, tb, tb_offset, number_of_lines_of_context)
  File "/opt/conda/envs/segmentation/lib/python3.7/site-packages/IPython/core/ultratb.py", line 1268, in structured_traceback
    self, etype, value, tb, tb_offset, number_of_lines_of_context
  File "/opt/conda/envs/segmentation/lib/python3.7/site-packages/IPython/core/ultratb.py", line 1125, in structured_traceback
    tb_offset)
  File "/opt/conda/envs/segmentation/lib/python3.7/site-packages/IPython/core/ultratb.py", line 1082, in format_exception_as_a_whole
    last_unique, recursion_repeat = find_recursion(orig_etype, evalue, records)
  File "/opt/conda/envs/segmentation/lib/python3.7/site-packages/IPython/core/ultratb.py", line 382, in find_recursion
    return len(records), 0
TypeError: object of type 'NoneType' has no len()
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/opt/conda/envs/segmentation/lib/python3.7/site-packages/IPython/core/interactiveshell.py", line 2064, in showtraceback
    stb = value._render_traceback_()
AttributeError: 'TypeError' object has no attribute '_render_traceback_'
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/opt/conda/envs/segmentation/lib/python3.7/site-packages/IPython/core/ultratb.py", line 1101, in get_records
    return _fixed_getinnerframes(etb, number_of_lines_of_context, tb_offset)
  File "/opt/conda/envs/segmentation/lib/python3.7/site-packages/IPython/core/ultratb.py", line 248, in wrapped
    return f(*args, **kwargs)
  File "/opt/conda/envs/segmentation/lib/python3.7/site-packages/IPython/core/ultratb.py", line 281, in _fixed_getinnerframes
    records = fix_frame_records_filenames(inspect.getinnerframes(etb, context))
  File "/opt/conda/envs/segmentation/lib/python3.7/inspect.py", line 1502, in getinnerframes
    frameinfo = (tb.tb_frame,) + getframeinfo(tb, context)
  File "/opt/conda/envs/segmentation/lib/python3.7/inspect.py", line 1460, in getframeinfo
    filename = getsourcefile(frame) or getfile(frame)
  File "/opt/conda/envs/segmentation/lib/python3.7/inspect.py", line 696, in getsourcefile
    if getattr(getmodule(object, filename), '__loader__', None) is not None:
  File "/opt/conda/envs/segmentation/lib/python3.7/inspect.py", line 742, in getmodule
    os.path.realpath(f)] = module.__name__
  File "/opt/conda/envs/segmentation/lib/python3.7/posixpath.py", line 395, in realpath
    path, ok = _joinrealpath(filename[:0], filename, {})
  File "/opt/conda/envs/segmentation/lib/python3.7/posixpath.py", line 429, in _joinrealpath
    if not islink(newpath):
  File "/opt/conda/envs/segmentation/lib/python3.7/posixpath.py", line 171, in islink
    st = os.lstat(path)
KeyboardInterrupt
Error in callback <function _WandbInit._pause_backend at 0x7fc25d859440> (for post_run_cell):
Exception in thread Thread-10:
Traceback (most recent call last):
  File "/opt/conda/envs/segmentation/lib/python3.7/threading.py", line 926, in _bootstrap_inner
    self.run()
  File "/opt/conda/envs/segmentation/lib/python3.7/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
  File "/opt/conda/envs/segmentation/lib/python3.7/site-packages/wandb/sdk/wandb_run.py", line 215, in check_status
    status_response = self._interface.communicate_stop_status()
  File "/opt/conda/envs/segmentation/lib/python3.7/site-packages/wandb/sdk/interface/interface.py", line 737, in communicate_stop_status
    resp = self._communicate(req, timeout=timeout, local=True)
  File "/opt/conda/envs/segmentation/lib/python3.7/site-packages/wandb/sdk/interface/interface.py", line 539, in _communicate
    return self._communicate_async(rec, local=local).get(timeout=timeout)
  File "/opt/conda/envs/segmentation/lib/python3.7/site-packages/wandb/sdk/interface/interface.py", line 544, in _communicate_async
    raise Exception("The wandb backend process has shutdown")
Exception: The wandb backend process has shutdown
Exception in thread Thread-11:
Traceback (most recent call last):
  File "/opt/conda/envs/segmentation/lib/python3.7/threading.py", line 926, in _bootstrap_inner
    self.run()
  File "/opt/conda/envs/segmentation/lib/python3.7/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
  File "/opt/conda/envs/segmentation/lib/python3.7/site-packages/wandb/sdk/wandb_run.py", line 197, in check_network_status
    status_response = self._interface.communicate_network_status()
  File "/opt/conda/envs/segmentation/lib/python3.7/site-packages/wandb/sdk/interface/interface.py", line 749, in communicate_network_status
    resp = self._communicate(req, timeout=timeout, local=True)
  File "/opt/conda/envs/segmentation/lib/python3.7/site-packages/wandb/sdk/interface/interface.py", line 539, in _communicate
    return self._communicate_async(rec, local=local).get(timeout=timeout)
  File "/opt/conda/envs/segmentation/lib/python3.7/site-packages/wandb/sdk/interface/interface.py", line 544, in _communicate_async
    raise Exception("The wandb backend process has shutdown")
Exception: The wandb backend process has shutdown
Error in callback <function _WandbInit._resume_backend at 0x7fc27d60bb90> (for pre_run_cell):
Error in callback <function _WandbInit._pause_backend at 0x7fc25d859440> (for post_run_cell):
ERROR! Session/line number was not unique in database. History logging moved to new session 12
Error in callback <function _WandbInit._resume_backend at 0x7fc27d60bb90> (for pre_run_cell):
Error in callback <function _WandbInit._pause_backend at 0x7fc25d859440> (for post_run_cell):